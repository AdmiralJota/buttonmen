<!DOCTYPE html>
<!--
    This document should be written in polyglot HTML5/XHTML5, and therefore
    should run when served either as text/html or application/xhtml+xml.
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>

    <meta charset="utf-8" />
    <title>Start new game</title>
    <link rel="stylesheet" href="gui.css" />

</head>

<body>
    <div class="title2">Create a new game</div>

    <br />

    <div>
        <table id="button_choice_table">
            <tr>
                <td>
                    Opponent:
                </td>
                <td>
                    <input type="text" name="opp_player_name"/>
                </td>
            </tr>
            <tr>
                <td>
                    Your button:
                </td>
                <td>
                    <select id="select_you">
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    Opponent's button:
                </td>
                <td>
                    <select id="select_opp">
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    Number of rounds:
                </td>
                <td>
                    <select>
                        <option value="nround_1">1</option>
                        <option value="nround_2">2</option>
                        <option value="nround_3">3</option>
                        <option value="nround_4">4</option>
                        <option value="nround_5">5</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>

    <br />

    <div ><button id="submit">Start game!</button></div>
    <br />
    <div><span id="submit_status"></span></div>

    <br />
    <div><span id="debug_message"></span></div>

    <!--
    james: eventually, we will want to use the hosted version of the JQuery library
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    -->
    <script src="jquery-1.9.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // global variables
            var buttonNameArray = new Array();

            // functions
            function loadButtonNames() {
                $.post('responder.php',
                       {type: 'loadButtonNames'},
                       function(rs){
                           // add buttons to selects
                           for (var buttonIdx = 0;
                                buttonIdx < rs.buttonNameArray.length;
                                buttonIdx++) {
                               var buttonName = rs.buttonNameArray[buttonIdx];
                               $('#select_you').append(
                                   $('<option></option>').
                                       text(buttonName).
                                       val('your_die_' + buttonName));
                               $('#select_opp').append(
                                   $('<option></option>').
                                       text(buttonName).
                                       val('opp_die_' + buttonName));
                           }
                       });
            };

            $('#submit').click(function() {
                // get both selections
                buttonNameArray[0] = $('#select_you').val();
                buttonNameArray[1] = $('#select_opp').val();

                // post both selections
                $.post('responder.php',
                       {type: 'chooseButtons',
                        buttonNameArray: buttonNameArray},
                       function(rs){
                           $('#submit_status').html(rs.data);
                       });
            });

            // code to run when page is ready
            loadButtonNames();
        });

    </script>
</body>
</html>