<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>JSON Testing</title>
        <style type="text/css">
            .selected { border-style:solid; border-color:red; }
        </style>
    </head>
    <body>
        <p><button id="fetch">Fetch JSON info!</button><br />
        <textarea id="result" style="width:500px; height:300px; font-size:10pt; font-family: Courier New, monospace">Waiting...</textarea></p>
        <p><strong>Name:</strong> <span id="rs_name">??</span></p>

        <img src="images/d6-1.png" alt="die image" width="50" id="playerIdx_0_dieIdx_0">
        <img src="images/d6-2.png" alt="die image" width="50" id="playerIdx_0_dieIdx_1">
        <img src="images/d6-3.png" alt="die image" width="50" id="playerIdx_1_dieIdx_0">
        <img src="images/d6-4.png" alt="die image" width="50" id="playerIdx_1_dieIdx_1">
        <p><button id="submit">Submit</button><br />

<!--
james: eventually, we will want to use the hosted version of the JQuery library
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
-->
        <script src="jquery-1.9.0.min.js"></script>
        <script>

            $(document).ready(function() {
                $('img').click(function(){
                    $(this).toggleClass('selected');
                });

                $('#fetch').click(function() {                      // When the button is clicked...
                    $('#result').html('Fetching...');               // Show that we're doing a network fetch
                    jQuery.ajax({                                   // Do a jQuery AJAX fetch
                        url: 'json_test_emitter.php',               // Returns a content-type of "application/json" so jQuery knows its a JSON object
                        success: function(rs, status, xhr) {
                            console.log(rs);                        // Debug; show that this is indeed a javascript object, and not just a string
                            $rs = $('#result');
                            if (rs.status == 'ok') {
                                $rs.html("JSON fetch succeeded!\nThe data of the result is:\n"+
                                         JSON.stringify(rs.data));  // Show the result
                                $('#rs_name').html(rs.data.name);   // Grab a specific data element from the result
                            } else {
                                $rs.html("JSON fetch failed\n"+
                                         JSON.stringify(rs.data));  // We got some JSON we didn't expect (the network fetch succeeded, but the engine had an error)
                            }
                        }
                    });
                });

                $('#submit').click(function() {
                    var dieText = '';
                    $("img.selected").each(function(index, element) {
                        dieText = dieText + $(element).attr('id') + '\n';
                    })
                    $('#result').html(dieText);
                });
            });
        </script>
    </body>
</html>